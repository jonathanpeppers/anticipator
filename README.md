# AnticipatorTest

Testing the `Anticipator`: 

https://github.com/xamarin/Xamarin.Forms/blob/4481863bb86010fecbfae41b5ffa1bd3eaa9f105/Xamarin.Forms.Platform.Android/Anticipator.cs

The idea is we can use a `Stopwatch` to compare its performance characteristics. I print the result to `adb logcat` output. We can average the time taken over 10 runs programmatically.

Run the powershell script included via:

    .\compare.ps1 -anticipator $true -configuration Debug
    .\compare.ps1 -anticipator $false -configuration Debug
    .\compare.ps1 -anticipator $true -configuration Release
    .\compare.ps1 -anticipator $false -configuration Release

There are other options in the script as well.

## Results

My general conclusion is the `Anticipator` has slightly *worse* performance when the intent was to improve it.

HAXM emulator (Debug):

```
> .\compare.ps1 -anticipator $true -configuration Debug
12-10 21:39:28.254 17515 17515 D GREPME  : 171
12-10 21:39:33.833 17562 17562 D GREPME  : 171
12-10 21:39:39.520 17612 17612 D GREPME  : 184
12-10 21:39:45.156 17661 17661 D GREPME  : 187
12-10 21:39:50.825 17713 17713 D GREPME  : 209
12-10 21:39:56.399 17764 17764 D GREPME  : 181
12-10 21:40:02.189 17818 17818 D GREPME  : 217
12-10 21:40:07.680 17867 17867 D GREPME  : 184
12-10 21:40:13.354 17916 17916 D GREPME  : 182
12-10 21:40:18.824 17963 17963 D GREPME  : 167
12-10 21:40:24.550 18013 18013 D GREPME  : 171
Average: 184
> .\compare.ps1 -anticipator $false -configuration Debug
12-10 21:41:29.402 18091 18091 D GREPME  : 179
12-10 21:41:35.026 18139 18139 D GREPME  : 180
12-10 21:41:40.606 18191 18191 D GREPME  : 167
12-10 21:41:46.294 18243 18243 D GREPME  : 176
12-10 21:41:51.840 18293 18293 D GREPME  : 172
12-10 21:41:57.500 18344 18344 D GREPME  : 169
12-10 21:42:03.115 18392 18392 D GREPME  : 186
12-10 21:42:08.701 18441 18441 D GREPME  : 172
12-10 21:42:14.370 18491 18491 D GREPME  : 179
12-10 21:42:20.000 18539 18539 D GREPME  : 186
12-10 21:42:25.591 18590 18590 D GREPME  : 177
Average: 176.636363636364
```

HAXM emulator (Release):

```
> .\compare.ps1 -anticipator $true -configuration Release
12-10 21:44:40.324 19073 19073 D GREPME  : 96
12-10 21:44:45.800 19125 19125 D GREPME  : 86
12-10 21:44:51.452 19179 19179 D GREPME  : 88
12-10 21:44:57.154 19301 19301 D GREPME  : 99
12-10 21:45:02.953 19496 19496 D GREPME  : 84
12-10 21:45:08.450 19587 19587 D GREPME  : 80
12-10 21:45:14.092 19669 19669 D GREPME  : 82
12-10 21:45:19.765 19717 19717 D GREPME  : 80
12-10 21:45:25.358 19764 19764 D GREPME  : 85
12-10 21:45:30.930 19810 19810 D GREPME  : 78
12-10 21:45:36.558 19855 19855 D GREPME  : 84
Average: 85.6363636363636
> .\compare.ps1 -anticipator $false -configuration Release
12-10 21:46:24.600 19982 19982 D GREPME  : 80
12-10 21:46:30.209 20027 20027 D GREPME  : 86
12-10 21:46:35.839 20073 20073 D GREPME  : 108
12-10 21:46:41.444 20122 20122 D GREPME  : 82
12-10 21:46:47.086 20176 20176 D GREPME  : 79
12-10 21:46:52.695 20222 20222 D GREPME  : 83
12-10 21:46:58.336 20273 20273 D GREPME  : 78
12-10 21:47:03.918 20324 20324 D GREPME  : 78
12-10 21:47:09.580 20369 20369 D GREPME  : 84
12-10 21:47:15.176 20415 20415 D GREPME  : 86
12-10 21:47:20.822 20460 20460 D GREPME  : 82
Average: 84.1818181818182
```

Pixel 3 XL (Debug):

```
> .\compare.ps1 -anticipator $true -configuration Debug
12-10 21:55:15.513 16641 16641 D GREPME  : 112
12-10 21:55:21.116 16710 16710 D GREPME  : 100
12-10 21:55:26.880 16779 16779 D GREPME  : 102
12-10 21:55:32.641 16842 16842 D GREPME  : 100
12-10 21:55:38.365 16908 16908 D GREPME  : 101
12-10 21:55:44.138 16972 16972 D GREPME  : 100
12-10 21:55:49.905 17037 17037 D GREPME  : 100
12-10 21:55:55.675 17100 17100 D GREPME  : 101
12-10 21:56:01.441 17165 17165 D GREPME  : 104
12-10 21:56:07.194 17231 17231 D GREPME  : 99
12-10 21:56:12.948 17296 17296 D GREPME  : 100
Average: 101.727272727273
> .\compare.ps1 -anticipator $false -configuration Debug
12-10 21:56:39.347 17427 17427 D GREPME  : 100
12-10 21:56:45.100 17495 17495 D GREPME  : 102
12-10 21:56:50.878 17563 17563 D GREPME  : 101
12-10 21:56:56.652 17630 17630 D GREPME  : 101
12-10 21:57:02.384 17694 17694 D GREPME  : 101
12-10 21:57:08.154 17757 17757 D GREPME  : 101
12-10 21:57:13.920 17828 17828 D GREPME  : 102
12-10 21:57:19.682 17893 17893 D GREPME  : 100
12-10 21:57:25.436 17957 17957 D GREPME  : 102
12-10 21:57:31.202 18022 18022 D GREPME  : 100
12-10 21:57:36.942 18086 18086 D GREPME  : 99
Average: 100.818181818182
```

Pixel 3 XL (Release):

```
> .\compare.ps1 -anticipator $true -configuration Release
12-10 21:59:48.536 18343 18343 D GREPME  : 39
12-10 21:59:54.303 18393 18393 D GREPME  : 38
12-10 22:00:00.053 18442 18442 D GREPME  : 39
12-10 22:00:05.803 18498 18498 D GREPME  : 38
12-10 22:00:11.554 18552 18552 D GREPME  : 38
12-10 22:00:17.319 18608 18608 D GREPME  : 39
12-10 22:00:23.102 18660 18660 D GREPME  : 38
12-10 22:00:28.843 18710 18710 D GREPME  : 38
12-10 22:00:34.581 18762 18762 D GREPME  : 39
12-10 22:00:40.326 18815 18815 D GREPME  : 38
12-10 22:00:46.077 18866 18866 D GREPME  : 38
Average: 38.3636363636364
> .\compare.ps1 -anticipator $false -configuration Release
12-10 22:03:34.503 18964 18964 D GREPME  : 38
12-10 22:03:40.264 19019 19019 D GREPME  : 38
12-10 22:03:45.984 19072 19072 D GREPME  : 38
12-10 22:03:51.731 19127 19127 D GREPME  : 38
12-10 22:03:57.474 19195 19195 D GREPME  : 39
12-10 22:04:03.240 19252 19252 D GREPME  : 38
12-10 22:04:08.949 19299 19299 D GREPME  : 38
12-10 22:04:14.719 19349 19349 D GREPME  : 38
12-10 22:04:20.467 19401 19401 D GREPME  : 38
12-10 22:04:26.262 19450 19450 D GREPME  : 39
12-10 22:04:32.037 19509 19509 D GREPME  : 40
Average: 38.3636363636364
```
(May not be noticeable on a fast device)
